#:kivy 1.9.1

# Copyright (C) 2017  Mariano Ramis

# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.

# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

#:include src/uix/configwidgets.kv

#:set minheight 35

<VideoFrame>:
  id: video
  rows: 5
  cols: 1
  name: "Video"
  spacing: 0, 4
  row_default_height: minheight
  row_force_default:True
  rows_minimum: {1: 150}
  walks: app.walks_container
  # Apertura
  GridLayout:
    rows: 1
    cols: 3
    Button:
      text: "Abrir"
      size_hint_x: 0.40
      on_release: root.show_load()
    Label:
      text: "Archivo:"
      size_hint_x: 0.20
    Label:
      id: show_file
      valign: 'middle'
      halign: 'left'
      text_size: self.size
  # Configuración
  GridLayout:
    rows: 2
    cols: 3
    id: configwidget
    FloatOption:
      label: u"Demora en reproducción"
      section_variable: "video-delay"
      option_values: [0, 0.15, 0.01]
    IntegerOption:
      id: startframe
      label: u"Cuadro incial"
      section_variable: "video-startframe"
      option_values: [0, 25000, 1]
    IntegerOption:
      id: endframe
      label: u"Cuadro final"
      section_variable: "video-endframe"
      option_values: [0, 25000, 1]
    IntegerOption:
      label: u"Límite de cuadros"
      section_variable: "explorer-emptyframelimit"
      option_values: [0, 120, 1]
    IntegerOption:
      label: u"Umbral de blanco"
      section_variable: "explorer-threshold"
      option_values: [200, 255, 1]
    BoolOption:
      label: u"Expandir detección"
      section_variable: "explorer-dilate"
  # Visualizaión
  Button:
    text: "Reproducir"
    on_release: root.show_video()
  # Exploración
  Button:
    text: "Explorar"
    on_release: root.run_explorer_thread()
  # Progreso
  GridLayout:
    rows: 2
    cols: 1
    Label:
      id: progresstext
      text: 'Progreso'
      valign: 'middle'
      halign: 'left'
      text_size: self.size
    ProgressBar:
      id: progressbar
      value: 0


<LoadDialog>:
  BoxLayout:
    size: root.size
    pos: root.pos
    orientation: "vertical"
    FileChooserListView:
      id: filechooser
      rootpath: root.source
    BoxLayout:
      size_hint_y: None
      height: minheight
      Button:
        text: "Seleccionar"
        on_release: root.load(filechooser.selection)
